function passwordStrength(e,s){return score=0,0==e.length?blankPass:e.length<4?shortPass:(e.toLowerCase()==s.toLowerCase(),score+=4*e.length,score+=1*(checkRepetition(1,e).length-e.length),score+=1*(checkRepetition(2,e).length-e.length),score+=1*(checkRepetition(3,e).length-e.length),score+=1*(checkRepetition(4,e).length-e.length),e.match(/(.*[0-9].*[0-9].*[0-9])/)&&(score+=5),e.match(/(.*[!,@,#,$,%,^,&,*,?,_,~].*[!,@,#,$,%,^,&,*,?,_,~])/)&&(score+=5),e.match(/([a-z].*[A-Z])|([A-Z].*[a-z])/)&&(score+=10),e.match(/([a-zA-Z])/)&&e.match(/([0-9])/)&&(score+=15),e.match(/([!,@,#,$,%,^,&,*,?,_,~])/)&&e.match(/([0-9])/)&&(score+=15),e.match(/([!,@,#,$,%,^,&,*,?,_,~])/)&&e.match(/([a-zA-Z])/)&&(score+=15),(e.match(/^\w+$/)||e.match(/^\d+$/))&&(score-=10),0>score&&(score=0),score>100&&(score=100),34>score?badPass:68>score?goodPass:strongPass)}function checkRepetition(e,s){for(res="",i=0;i<s.length;i++){for(repeated=!0,j=0;e>j&&j+i+e<s.length;j++)repeated=repeated&&s.charAt(j+i)==s.charAt(j+i+e);e>j&&(repeated=!1),repeated?(i+=e-1,repeated=!1):res+=s.charAt(i)}return res}function showRateField(e){jQuery("#result-blank").addClass("hidden"),jQuery("#result-short").addClass("hidden"),jQuery("#result-bad").addClass("hidden"),jQuery("#result-good").addClass("hidden"),jQuery("#result-strong").addClass("hidden"),jQuery(e).removeClass("hidden")}var blankPass=-1,shortPass=0,badPass=1,goodPass=2,strongPass=3;jQuery(document).ready(function(){jQuery("#user_pw").keyup(function(){var e=passwordStrength(jQuery("#user_pw").val(),jQuery("#user_login").val());e==blankPass?showRateField("#result-blank"):e==shortPass?showRateField("#result-short"):e==badPass?showRateField("#result-bad"):e==goodPass?showRateField("#result-good"):e==strongPass&&showRateField("#result-strong")})});