<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"><channel><title>DIEGO PEREIRA GRASSATO's RSS feed</title><link>http://softwarelivre.org/dtux</link><description>DIEGO PEREIRA GRASSATO's content published at Software Livre Brasil</description><item><title>Replica de dados entre servidores Samba4 com load-balance de DNS</title><description>&lt;p&gt;A partir da versão &lt;strong&gt;&lt;em&gt;Alpha 11 do Samba4&lt;/em&gt;&lt;/strong&gt; possui a capacidade de aderir um controlador de domínio adicional a um  controlador de domínio já existente, este recurso é útil para melhorar a  disponibilidade e a confiabilidade dos serviços de rede. Adicionar  outros controladores de domínio pode ajudar a fornecer tolerância a  falhas, equilibrar a carga de controladores de domínio existentes.&lt;/p&gt;
&lt;p&gt;O fato de haver mais de um controlador de domínio em um domínio  permite que o domínio continue a funcionar se um controlador de domínio  falhar ou precisar ser desconectado. Vários controladores de domínio  também podem melhorar o desempenho, pois facilitam a conexão de um  cliente com um controlador de domínio durante o logon em rede. Você pode  adicionar outros controladores de domínio pela rede tanto sendo &lt;strong&gt;&lt;em&gt;“Samba4 &amp;lt; – &amp;gt; Samba4, ou Samb4 &amp;lt; – &amp;gt; Samba4 &amp;lt; – &amp;gt; Windows Server 2008 Server”,&lt;/em&gt;&lt;/strong&gt; que vai dar a sua rede uma infraestrutura multi-plataforma com uma base heterógena e única.&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;strong&gt;&lt;span style="text-decoration: underline;"&gt;Montando a estrutura de replica&lt;/span&gt;&lt;/strong&gt;&lt;strong&gt; &lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Primeiramente é necessário ter duas instalações do Samba4, no qual  uma completa com o domínio configurado, outra sem o domínio configurado.  Os passos da instalação podem ser seguidos aqui:&lt;/p&gt;
&lt;p&gt;Link1 = &lt;a href="http://diegograssato.wordpress.com/2010/09/13/2009/10/06/instalacao-e-configuracao-samba4/"&gt;http://diegograssato.wordpress.com/2009/10/06/instalacao-e-configuracao-samba4/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Link2 = &lt;a href="http://wiki.samba.org/index.php/Samba4/HOWTO"&gt;http://wiki.samba.org/index.php/Samba4/HOWTO&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Pulem somente o passo da configuração dos domínios feitos pelo &lt;strong&gt;&lt;em&gt;“provision”.&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;a href="http://diegograssato.files.wordpress.com/2010/09/vlcsnap-2010-07-08-07h58m49s83.png"&gt;&lt;br&gt; &lt;/a&gt;&lt;strong&gt;&lt;span style="text-decoration: underline;"&gt;Configuração do Controlador de Domínios Primários&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;span style="text-decoration: underline;"&gt; &lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;#./setup/provision –realm=tux.org –domain=TUX –adminpass=d13g@anna –server-role=’domain controller’&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;strong&gt;&lt;span style="text-decoration: underline;"&gt;Configuração do Controlador de Domínios Replica 1&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;No controlador secundário, após a instalação do sistema e a configuração correta do &lt;strong&gt;DNS&lt;/strong&gt; vamos para as configurações para integra-lo ao samba4 e faze-lo de servidor de replica de dados:&lt;/p&gt;
&lt;p&gt;Primeiro passo &lt;strong&gt;&lt;em&gt;“INICIAR -&amp;gt; RUN”&lt;/em&gt;&lt;/strong&gt;, digite &lt;strong&gt;&lt;em&gt;“dcpromo”&lt;/em&gt;&lt;/strong&gt;:&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;a href="http://diegograssato.files.wordpress.com/2010/09/vlcsnap-2010-07-08-07h58m49s83.png"&gt;&lt;img title="vlcsnap-2010-07-08-07h58m49s83" class="aligncenter" src="http://diegograssato.files.wordpress.com/2010/09/vlcsnap-2010-07-08-07h58m49s83.png?w=300&amp;amp;h=162" height="162" alt="" width="300"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Aparecerá uma mensagem de erro ignore-a e click em &lt;strong&gt;&lt;em&gt;“NEXT”:&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;strong&gt;&lt;em&gt;&lt;a href="http://diegograssato.files.wordpress.com/2010/09/vlcsnap-2010-07-08-07h59m44s140.png"&gt;&lt;img title="vlcsnap-2010-07-08-07h59m44s140" class="aligncenter size-medium wp-image-358" src="http://diegograssato.files.wordpress.com/2010/09/vlcsnap-2010-07-08-07h59m44s140.png?w=300&amp;amp;h=290" height="290" alt="" width="300"&gt;&lt;/a&gt;&lt;br&gt; &lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Marque a opção &lt;strong&gt;&lt;em&gt;“EXISTING FOREST”,&lt;/em&gt;&lt;/strong&gt; que irá vincula-lo a uma floresta já existente.&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;a href="http://diegograssato.files.wordpress.com/2010/09/vlcsnap-2010-07-08-08h00m11s152.png"&gt;&lt;img title="vlcsnap-2010-07-08-08h00m11s152" class="aligncenter size-medium wp-image-359" src="http://diegograssato.files.wordpress.com/2010/09/vlcsnap-2010-07-08-08h00m11s152.png?w=300&amp;amp;h=240" height="240" alt="" width="300"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Digite o nome de domínio que se deseja vincular:&lt;a href="http://diegograssato.files.wordpress.com/2010/09/2.png"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;img title="2" class="aligncenter size-medium wp-image-360" src="http://diegograssato.files.wordpress.com/2010/09/2.png?w=300&amp;amp;h=280" height="280" alt="" width="300"&gt;&lt;/p&gt;
&lt;p&gt;Click em &lt;strong&gt;&lt;em&gt;“SET”&lt;/em&gt;&lt;/strong&gt; logo abaixo e entre com as credenciais de administrator do domínio adicionado acima.&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;a href="http://diegograssato.files.wordpress.com/2010/09/3.png"&gt;&lt;img title="3" class="aligncenter size-medium wp-image-361" src="http://diegograssato.files.wordpress.com/2010/09/3.png?w=300&amp;amp;h=287" height="287" alt="" width="300"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;a href="http://diegograssato.files.wordpress.com/2010/09/4.png"&gt;&lt;img title="4" class="aligncenter size-medium wp-image-363" src="http://diegograssato.files.wordpress.com/2010/09/4.png?w=300&amp;amp;h=282" height="282" alt="" width="300"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Selecione a Floresta Principal:&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;a href="http://diegograssato.files.wordpress.com/2010/09/5.png"&gt;&lt;img title="5" class="aligncenter size-medium wp-image-362" src="http://diegograssato.files.wordpress.com/2010/09/5.png?w=300&amp;amp;h=280" height="280" alt="" width="300"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Selecione o site do controlador default:&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;a href="http://diegograssato.files.wordpress.com/2010/09/6.png"&gt;&lt;img title="6" class="aligncenter size-medium wp-image-364" src="http://diegograssato.files.wordpress.com/2010/09/6.png?w=300&amp;amp;h=280" height="280" alt="" width="300"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Passemos para a parte de verificação de &lt;strong&gt;&lt;em&gt;DNS&lt;/em&gt;&lt;/strong&gt;, desmarque a opção &lt;strong&gt;&lt;em&gt;“DNS server” &lt;/em&gt;&lt;/strong&gt; e &lt;strong&gt;&lt;em&gt;“Read-only domain controler”&lt;/em&gt;&lt;/strong&gt; deixe somente o catalogo global:&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;a href="http://diegograssato.files.wordpress.com/2010/09/7.png"&gt;&lt;img title="7" class="aligncenter size-medium wp-image-365" src="http://diegograssato.files.wordpress.com/2010/09/7.png?w=300&amp;amp;h=287" height="287" alt="" width="300"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Próximo passo será é a verificação do &lt;strong&gt;&lt;em&gt;DNS&lt;/em&gt;&lt;/strong&gt;:&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;a href="http://diegograssato.files.wordpress.com/2010/09/8.png"&gt;&lt;img title="8" class="aligncenter size-medium wp-image-366" src="http://diegograssato.files.wordpress.com/2010/09/8.png?w=300&amp;amp;h=285" height="285" alt="" width="300"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Irá aparecer um erro, mas click em &lt;strong&gt;&lt;em&gt;“Yes”&lt;/em&gt;&lt;/strong&gt; mais tarde iremos adicionar as entradas &lt;strong&gt;&lt;em&gt;DNS&lt;/em&gt;&lt;/strong&gt; do servidor manualmente no servidor.&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;a href="http://diegograssato.files.wordpress.com/2010/09/9.png"&gt;&lt;img title="9" class="aligncenter size-medium wp-image-367" src="http://diegograssato.files.wordpress.com/2010/09/9.png?w=300&amp;amp;h=288" height="288" alt="" width="300"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Configuração feita você pode fazer a exportação dos dados para poder utilizar posteriormente, avence para próxima etapa:&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;a href="http://diegograssato.files.wordpress.com/2010/09/10.png"&gt;&lt;img title="10" class="aligncenter size-medium wp-image-368" src="http://diegograssato.files.wordpress.com/2010/09/10.png?w=300&amp;amp;h=283" height="283" alt="" width="300"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Nesta etapa que pode demora um pouco o servidor irá importa os catálogos do &lt;strong&gt;&lt;em&gt;Samba4&lt;/em&gt;&lt;/strong&gt; para utilização é feito o sincronismo com a base do &lt;strong&gt;&lt;em&gt;Samba4&lt;/em&gt;&lt;/strong&gt;.&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;a href="http://diegograssato.files.wordpress.com/2010/09/vlcsnap-2010-07-08-08h15m23s69.png"&gt;&lt;img title="vlcsnap-2010-07-08-08h15m23s69" class="aligncenter size-medium wp-image-370" src="http://diegograssato.files.wordpress.com/2010/09/vlcsnap-2010-07-08-08h15m23s69.png?w=300&amp;amp;h=281" height="281" alt="" width="300"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Processo finalizado o servidor irá reinicia para que aplique as  configurações e já volta replicando, mas antes de iniciarmos o servidor  iremos adicionar a entrada do host do servidor no nosso servidor &lt;strong&gt;&lt;em&gt;DNS&lt;/em&gt;&lt;/strong&gt;, para adicionarmos o servidor precisamos de seu número de identificação &lt;strong&gt;&lt;em&gt;“GUID”,&lt;/em&gt;&lt;/strong&gt; pois é através dele que feita autorização pelo servidor &lt;strong&gt;&lt;em&gt;Samba4&lt;/em&gt;&lt;/strong&gt; caso contrario o &lt;strong&gt;&lt;span style="text-decoration: underline;"&gt;Samba4&lt;/span&gt;&lt;/strong&gt; acusará alguns erros:&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;a href="http://diegograssato.files.wordpress.com/2010/09/sem-titulo2.png"&gt;&lt;img title="Sem título2" class="aligncenter size-medium wp-image-371" src="http://diegograssato.files.wordpress.com/2010/09/sem-titulo2.png?w=300&amp;amp;h=59" height="59" alt="" width="300"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Para descobrimos o &lt;strong&gt;&lt;em&gt;“GUID”&lt;/em&gt;&lt;/strong&gt; de replica irá digitar o seguinte comando no servidor onde está o &lt;strong&gt;&lt;em&gt;Samba4&lt;/em&gt;&lt;/strong&gt;:&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;a href="http://diegograssato.files.wordpress.com/2010/09/sem-titulo3.png"&gt;&lt;img title="Sem título3" class="aligncenter size-medium wp-image-372" src="http://diegograssato.files.wordpress.com/2010/09/sem-titulo3.png?w=300&amp;amp;h=105" height="105" alt="" width="300"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;#ldbsearch -H /var/lib/samba/private/sam.ldb objectClass=ntdsdsa objectguid –cross-ncs&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt; &lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Ele irá mostrar o &lt;strong&gt;&lt;em&gt;“GUID”&lt;/em&gt;&lt;/strong&gt; dos dois servidores copie a entrada que fala de nosso servidor &lt;strong&gt;&lt;em&gt;Windows 2008&lt;/em&gt;&lt;/strong&gt; e abra o arquivo de configuração da zona criada pelo &lt;strong&gt;&lt;em&gt;Samba4 &lt;/em&gt;&lt;/strong&gt;que está localizada em &lt;strong&gt;&lt;em&gt;“/var/lib/samba/private/dns/tux.org”&lt;/em&gt;&lt;/strong&gt;.&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;a href="http://diegograssato.files.wordpress.com/2010/09/sem-titulo4.png"&gt;&lt;img title="Sem título4" class="aligncenter size-medium wp-image-373" src="http://diegograssato.files.wordpress.com/2010/09/sem-titulo4.png?w=300&amp;amp;h=105" height="105" alt="" width="300"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Após adicionar as entradas reinicie o servidor &lt;strong&gt;&lt;em&gt;DNS&lt;/em&gt;&lt;/strong&gt; e inicie o &lt;strong&gt;&lt;em&gt;Windows 2008&lt;/em&gt;&lt;/strong&gt;, agora vamos testar se a replica está funcionando corretamente.&lt;/p&gt;
&lt;p&gt;No &lt;em&gt;shell&lt;/em&gt; do &lt;strong&gt;&lt;em&gt;DC&lt;/em&gt;&lt;/strong&gt; primário use o comando &lt;strong&gt;&lt;em&gt;“net”&lt;/em&gt;&lt;/strong&gt; para adicionar um novo usuário:&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;a href="http://diegograssato.files.wordpress.com/2010/09/sem-titulo.png"&gt;&lt;img title="Sem título" class="aligncenter size-medium wp-image-374" src="http://diegograssato.files.wordpress.com/2010/09/sem-titulo.png?w=300&amp;amp;h=187" height="187" alt="" width="300"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;No caso criamos o usuário “Anna”, vamos verificar usando o comando &lt;strong&gt;&lt;em&gt;“wbinfo -u&lt;/em&gt;&lt;/strong&gt;”:&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;a href="http://diegograssato.files.wordpress.com/2010/09/sem-titulo7.png"&gt;&lt;img title="Sem título7" class="aligncenter size-medium wp-image-375" src="http://diegograssato.files.wordpress.com/2010/09/sem-titulo7.png?w=300&amp;amp;h=105" height="105" alt="" width="300"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Ele listará todos usuários.&lt;/p&gt;
&lt;p&gt;Logue-se agora no servidor Windows 2008 Server, como administrator, vá ao meu &lt;strong&gt;&lt;em&gt;“INCIAR -&amp;gt; RUN -&amp;gt; das.msc&lt;/em&gt;&lt;/strong&gt;”, vá na guia usar que está e &lt;strong&gt;&lt;em&gt;Users&lt;/em&gt;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;a href="http://diegograssato.files.wordpress.com/2010/09/sem-titulo9.png"&gt;&lt;br&gt; &lt;/a&gt;&lt;a href="http://diegograssato.files.wordpress.com/2010/09/sem-titulo6.png"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;img title="Sem título6" class="aligncenter size-medium wp-image-377" src="http://diegograssato.files.wordpress.com/2010/09/sem-titulo6.png?w=300&amp;amp;h=179" height="179" alt="" width="300"&gt;&lt;/p&gt;
&lt;p&gt;Criaremos agora  um usuário no Servidor 2008. Remova o usuário usando  o utilitário do Windows e Cadastre um outro usuário, usando o  formulário do &lt;strong&gt;&lt;em&gt;“DSA”.&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;&lt;a href="http://diegograssato.files.wordpress.com/2010/09/wbinfo.png"&gt;&lt;br&gt; &lt;/a&gt;&lt;br&gt; &lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Verificando no &lt;strong&gt;&lt;em&gt;Samba4&lt;/em&gt;&lt;/strong&gt; se replicou os dados:&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;strong&gt;&lt;em&gt;&lt;a href="http://diegograssato.files.wordpress.com/2010/09/wbinfo.png"&gt;&lt;img title="wbinfo" class="aligncenter" src="http://diegograssato.files.wordpress.com/2010/09/wbinfo.png?w=300&amp;amp;h=38" height="38" alt="" width="300"&gt;&lt;/a&gt;&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Replicando dados perfeitinhos, vá à guia &lt;strong&gt;&lt;em&gt;“Domain Controllers”&lt;/em&gt;&lt;/strong&gt; você verá os dois controladores ativo.&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;a href="http://diegograssato.files.wordpress.com/2010/09/sem-titulo91.png"&gt;&lt;img title="Sem título9" class="aligncenter size-medium wp-image-379" src="http://diegograssato.files.wordpress.com/2010/09/sem-titulo91.png?w=300&amp;amp;h=244" height="244" alt="" width="300"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;strong&gt;&lt;span style="text-decoration: underline;"&gt;Configuração do Controlador de Domínios Replica 2&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;span style="text-decoration: underline;"&gt; &lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Nesta segunda replica nos usaremos outra máquina rodando &lt;strong&gt;&lt;span style="text-decoration: underline;"&gt;Samba4&lt;/span&gt;&lt;/strong&gt;, siga as passos da instalação padrão só pule  a aparte do “&lt;strong&gt;&lt;em&gt;provision”&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;#net vampire TUX.ORG -UAdministrator –realm=tux.org&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;&lt;br&gt; &lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Coloque a senha do administrator de domínios e em alguns instantes sua segunda replica está no ar.&lt;/p&gt;
&lt;p&gt;Antes de iniciar o serviço rode novamente o seguinte comando para  obter e adicionar o “GUID” deste servidor ao servidor DNS e o DC  primário possa encontra-lo na rede.&lt;/p&gt;
&lt;p&gt;O atributo &lt;strong&gt;&lt;em&gt;objectGUID&lt;/em&gt;&lt;/strong&gt; é um atributo de identificação, o valor do objeto &lt;strong&gt;&lt;em&gt;objectGUID&lt;/em&gt;&lt;/strong&gt; é &lt;strong&gt;&lt;em&gt;GUID&lt;/em&gt;&lt;/strong&gt; atribuído quando o objeto foi criado e é imudável depois, a replicação  depende da integridade do atributo &lt;strong&gt;&lt;em&gt;objectGUID&lt;/em&gt;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;#ldbsearch -H /var/lib/samba/private/sam.ldb objectClass=ntdsdsa objectguid –cross-ncs&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;strong&gt;&lt;em&gt;&lt;a href="http://diegograssato.files.wordpress.com/2010/09/do2.png"&gt;&lt;img title="do2" class="aligncenter" src="http://diegograssato.files.wordpress.com/2010/09/do2.png?w=362&amp;amp;h=127" height="127" alt="" width="362"&gt;&lt;/a&gt;&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt; &lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Ele irá mostrar o &lt;strong&gt;&lt;em&gt;“GUID”&lt;/em&gt;&lt;/strong&gt; dos dois servidores copie a entrada que fala de nosso servidor &lt;strong&gt;&lt;em&gt;Windows 2008&lt;/em&gt;&lt;/strong&gt; e abra o arquivo de configuração da zona criada pelo &lt;strong&gt;&lt;em&gt;Samba4 &lt;/em&gt;&lt;/strong&gt;que está localizada em &lt;strong&gt;&lt;em&gt;“/var/lib/samba/private/dns/tux.org”&lt;/em&gt;&lt;/strong&gt;.&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;a href="http://diegograssato.files.wordpress.com/2010/09/do21.png"&gt;&lt;img title="do21" class="aligncenter size-medium wp-image-383" src="http://diegograssato.files.wordpress.com/2010/09/do21.png?w=300&amp;amp;h=105" height="105" alt="" width="300"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Após adicionar as entradas reinicie o servidor &lt;strong&gt;&lt;em&gt;DNS&lt;/em&gt;&lt;/strong&gt; e inicie o &lt;strong&gt;&lt;em&gt;Windows 2008&lt;/em&gt;&lt;/strong&gt;, agora vamos testar se a replica está funcionando corretamente.&lt;/p&gt;
&lt;p&gt;No shell do &lt;strong&gt;&lt;em&gt;Servidor Replica 2&lt;/em&gt;&lt;/strong&gt; primário use o comando &lt;strong&gt;&lt;em&gt;“net”&lt;/em&gt;&lt;/strong&gt; para adicionar um novo usuário:&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;a href="http://diegograssato.files.wordpress.com/2010/09/newuser.png"&gt;&lt;img title="newuser" class="aligncenter size-medium wp-image-384" src="http://diegograssato.files.wordpress.com/2010/09/newuser.png?w=300&amp;amp;h=105" height="105" alt="" width="300"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;No caso criamos o usuário “Anna”, vamos verificar usando o comando &lt;strong&gt;&lt;em&gt;“wbinfo&lt;/em&gt;&lt;/strong&gt;” no servidor DC principal:&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;a href="http://diegograssato.files.wordpress.com/2010/09/wbinfo1.png"&gt;&lt;img title="wbinfo" class="aligncenter size-medium wp-image-385" src="http://diegograssato.files.wordpress.com/2010/09/wbinfo1.png?w=300&amp;amp;h=105" height="105" alt="" width="300"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;OK Funcionando e se você verifica no Windows 2008 Server já está atualizado também.&lt;/p&gt;
&lt;p&gt;Vamos adicionar a nossa regra de load-balance de Domínio em nosso  servidor DNS para que os dados sejam replicados podemos fazer um  balanceamento de requisições caso um servidores pare o outro assume até  que ele volte, quando ele volta os dados são repassado a eles, para  fazer esse balanceamento é simples, abra o arquivo de configuração de  sua zona e adicione a seguinte entrada, logo abaixo&lt;strong&gt;&lt;em&gt;” IN A    192.168.11.1”&lt;/em&gt;&lt;/strong&gt; adicione:&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;strong&gt;IN A    192.168.11.18&lt;/strong&gt;&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;strong&gt;IN A    192.168.11.12&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt; &lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Assim sempre o acesso será balanceado pelo servidor &lt;strong&gt;&lt;em&gt;DNS&lt;/em&gt;&lt;/strong&gt; e caso um dos dois pare e outro irá continuar trabalhando, quando o &lt;strong&gt;&lt;em&gt;DC&lt;/em&gt;&lt;/strong&gt; voltar ele irá importar os dados para que as informações sempre fiquem integras.&lt;/p&gt;
&lt;p&gt;Para testarmos se está funcionado utilize o comando “&lt;strong&gt;&lt;em&gt;ping&lt;/em&gt;&lt;/strong&gt;”;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Primeiro teste&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;# ping tux.org&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;PING tux.org (192.168.11.1) 56(84) bytes of data.&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;64 bytes from tux.org (192.168.11.1): icmp_seq=1 ttl=64 time=0.253 ms&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;64 bytes from tux.org  (192.168.11.1): icmp_seq=2 ttl=64 time=0.087 ms&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;&lt;br&gt; &lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt; &lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Segundo teste&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;# ping tux.org&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;PING tux.org (192.168.11.12) 56(84) bytes of data.&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;64 bytes from tux.org (192.168.11.12): icmp_seq=1 ttl=64 time=0.253 ms&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;64 bytes from tux.org  (192.168.11.12): icmp_seq=2 ttl=64 time=0.087 ms&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;&lt;br&gt; &lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Terceiro teste&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;# ping tux.org&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;PING tux.org (192.168.11.18) 56(84) bytes of data.&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;64 bytes from tux.org (192.168.11.18): icmp_seq=1 ttl=64 time=0.253 ms&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;64 bytes from tux.org  (192.168.11.18): icmp_seq=2 ttl=64 time=0.087 ms&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;</description><pubDate>Mon, 13 Sep 2010 12:16:58 +0000</pubDate><link>http://softwarelivre.org/dtux/blog/replica-de-dados-entre-servidores-samba4-com-load-balance-de-dns</link><guid>http://softwarelivre.org/dtux/blog/replica-de-dados-entre-servidores-samba4-com-load-balance-de-dns</guid></item><item><title>Openfire,  Asterisk Interagindo Voip com Seus Clientes Internos</title><description>&lt;p style="text-align: center;"&gt;&lt;span style="font-size: x-small;"&gt;&lt;img src="/articles/0013/9372/img-303-96x96.png1256735544" height="101" alt="Img-303-96x96" width="101"&gt; &lt;img src="/articles/0013/9373/openfire-512.png1256735546" height="98" alt="Openfire-512" width="98"&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;O Openfire é um servidor Jabber desenvolvido em Java pela Ignite Realtime,ele passou por inúmeras melhorias, recebendo mais recursos e aprimorando os que já existiam (como a autenticação LDAP e Active Directory, por exemplo).&lt;br&gt;&lt;br&gt;O Openfire tem uma gama imensa de recursos, um dos mais interessantes é o uso de plugins, que permitem extender as funcionalidades do servidor. Existe quase uma dezena de plugins disponíveis (e outros que já estão em desenvolvimento), no nosso caso usaremos o "&lt;strong&gt;SIP Phone Plugin"&lt;/strong&gt;:&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span class="Apple-style-span" style="border-collapse: separate; color: #000000; font-family: 'Times New Roman'; font-size: medium; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; text-indent: 0px; white-space: normal;"&gt;&lt;span class="Apple-style-span" style="color: #333333; font-family: verdana,arial,helvetica,sans-serif; font-size: 12px; text-align: left; white-space: nowrap;"&gt;&lt;strong&gt;SIP Phone Plugin:&lt;/strong&gt; Plugin que provê a comunicação dos usuário com contas VOIP.&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="font-size: small;"&gt;Não irei aborta a instalação nem configuração dos clientes no Openfire, irei abordar somente a adequação dos clientes para trabalhar com sistema voip com asterisk. Segue abaixo alguns link sobre a instalação do OpenFire:&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: left;"&gt;&lt;span style="font-size: small;"&gt;Instalação: &lt;strong&gt;http://www.nisled.org/?tag=openfire&lt;br&gt;http://www.vivaolinux.com.br/artigo/Servidor-Jabber-com-Openfire-+-MySQL-+-Debian-Lenny&lt;/strong&gt;&lt;br&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: left;"&gt;Bom a parte inicial é nosso ambiente de trabalho:&lt;br&gt;·&lt;strong&gt; Linux: Slackware 12.2 – Current Version&lt;/strong&gt;&lt;/p&gt;
&lt;p style="text-align: left;"&gt;ftp://ftp.slackware.no/pub/linux/ISO-images/slackware/Current-ISObuild/&lt;br&gt;·&lt;strong&gt; Libpri&lt;/strong&gt;&lt;br&gt;http://downloads.asterisk.org/pub/telephony/libpri/libpri-1.2.8.tar.gz&lt;/p&gt;
&lt;p style="text-align: left;"&gt;· &lt;strong&gt;Asterisk 1.6.1&lt;/strong&gt;&lt;br&gt;http://downloads.asterisk.org/pub/telephony/asterisk/releases/asterisk-1.6.1.1.tar.gz&lt;br&gt;·&lt;strong&gt; Asterisk-Addons 1.6.2.0 rc1&lt;/strong&gt;&lt;br&gt;http://downloads.asterisk.org/pub/telephony/asterisk/releases/asterisk-addons-1.6.2.0-rc1.tar.gz&lt;/p&gt;
&lt;p style="text-align: left;"&gt;&lt;strong&gt;· Asterisk-sounds 1.2.1&lt;/strong&gt;&lt;br&gt;http://downloads.asterisk.org/pub/telephony/asterisk/releases/asterisk-sounds-1.2.1.tar.gz&lt;/p&gt;
&lt;p style="text-align: left;"&gt;&lt;strong&gt;· Servidor rodando Openfire devidamente configurado com busca de usuário utilizando OpenLDAP ou Mysql.&lt;/strong&gt;&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;span style="text-decoration: underline;"&gt;&lt;strong&gt;&lt;br&gt;&lt;span style="font-size: medium;"&gt;Instalação e configuração do Asterisk&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;strong&gt;&lt;br&gt;&lt;/strong&gt;O Asterisk é um software PBX que usa o conceito de software livre, criado inicialmente por Mark Spencer, fundador da empresa Digium. Com o Asterisk você pode criar diversas aplicações a um baixo custo, com a mesma, se não superioridade de muitos PABX encontrados hoje no mercado de telecomunicações.&lt;br&gt;Entenda que o Asterisk é muito mais que um PABX padrão. Com o Asterisk em sua rede, você cria novas aplicações em telefônia.&lt;/p&gt;
&lt;p style="text-align: left;"&gt;Algumas como:&lt;strong&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p style="text-align: left;"&gt;&lt;strong&gt;· URA (Unidade de Resposta Audível);&lt;br&gt;· Filas de chamadas para Call Centers e outras atividades;&lt;br&gt;· VoiceMail;&lt;br&gt;· Atendimento Programado;&lt;br&gt;· Servidor de Fax;&lt;br&gt;· Conferência;&lt;br&gt;· VideoConferência;&lt;br&gt;· Bilhetagem detalhada;&lt;br&gt;· Planos de chamadas (DialPlain);&lt;br&gt;· CRM&lt;br&gt;· e muitos outros...&lt;/strong&gt;&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;span style="font-size: small;"&gt;&lt;br&gt;&lt;span style="font-size: medium;"&gt;&lt;span style="text-decoration: underline;"&gt;&lt;strong&gt;Instalando o Asterisk&lt;/strong&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="text-decoration: underline;"&gt;&lt;strong&gt;&lt;/strong&gt;&lt;/span&gt;&lt;br&gt;Após o download dos pacotes vamos compactá-los, o primeiro que iremos instalar será o libpri depois o asterisk:&lt;/p&gt;
&lt;p style="text-align: left;"&gt;&lt;br&gt;&lt;strong&gt;-LibPri&lt;/strong&gt;&lt;br&gt;root@host# tar -zxvf libpri-1.2.8.tar.gz&lt;br&gt;root@host# cd libpri-1.2.8&lt;br&gt;root@host# make &amp;amp;&amp;amp; mak install&lt;/p&gt;
&lt;p style="text-align: left;"&gt;&lt;br&gt;&lt;strong&gt;-Asterisk&lt;/strong&gt;&lt;br&gt;root@host# tar –zxvf asterisk-1.6.1.1.tar.gz&lt;br&gt;root@host# cd asterisk-1.6.1.1&lt;br&gt;root@host# ./configure --prefix=/usr --sysconfdir=/etc --&lt;br&gt;localstatedir=/var --mandir=/usr/man&lt;br&gt;root@host# make &amp;amp;&amp;amp; make install&lt;br&gt;root@host# make samples &amp;amp;&amp;amp; make progdocs&lt;/p&gt;
&lt;p style="text-align: left;"&gt;&lt;br&gt;&lt;strong&gt;-Addons&lt;/strong&gt;&lt;br&gt;root@host# tar -zxvf asterisk-addons-1.6.2.0-rc1.tar.gz&lt;br&gt;root@host# cd asterisk-addons-1.6.2.0-rc1&lt;br&gt;root@host# ./configure --prefix=/usr --sysconfdir=/etc --&lt;br&gt;localstatedir=/var --mandir=/usr/man&lt;br&gt;root@host# make &amp;amp;&amp;amp; make install&lt;/p&gt;
&lt;p style="text-align: left;"&gt;&lt;br&gt;&lt;strong&gt;-Souns&lt;/strong&gt;&lt;br&gt;root@host# tar -zxvf asterisk-sounds-1.2.1.tar.gz&lt;br&gt;root@host# cd asterisk-sounds-1.2.1&lt;br&gt;root@host# make install&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;span style="font-size: medium;"&gt;&lt;strong&gt;Script de incialização:&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;#========================================================================&lt;br&gt;#!/bin/sh&lt;br&gt;#&lt;br&gt;# Start/stop/restart Asterisk PBX&lt;br&gt;asterisk_start() {&lt;br&gt; if [ -x /usr/sbin/asterisk ]; then&lt;br&gt; VERSION=`/usr/sbin/asterisk -rx 'core show version'`&lt;br&gt; &lt;br&gt; if [ "`echo $VERSION | cut -c 1-8`" = "Asterisk" ]; then&lt;br&gt; echo "Asterisk está em funcionamento. $0 saindo agora."&lt;br&gt; exit 1&lt;br&gt; fi&lt;br&gt;&lt;br&gt; echo "Starting Asterisk /usr/sbin/asterisk"&lt;br&gt; /usr/sbin/asterisk&lt;br&gt; fi&lt;br&gt; }&lt;br&gt;asterisk_stop() {&lt;br&gt; if [ -r /var/run/asterisk.pid ]; then&lt;br&gt; killall asterisk&lt;br&gt; fi&lt;br&gt;}&lt;br&gt;&lt;br&gt;asterisk_restart() {&lt;br&gt; asterisk_stop&lt;br&gt; asterisk_start&lt;br&gt;}&lt;br&gt;&lt;br&gt; case "$1" in&lt;br&gt; 'start')&lt;br&gt; asterisk_start&lt;br&gt; ;;&lt;br&gt;&lt;br&gt; 'stop')&lt;br&gt; asterisk_stop&lt;br&gt; ;;&lt;br&gt; 'restart')&lt;br&gt; asterisk_restart&lt;br&gt; ;;&lt;br&gt; *)&lt;br&gt;&lt;br&gt; echo "usage $0 start|stop|restart" ;;&lt;br&gt; esac&lt;br&gt;#========================================================================&lt;/strong&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Salve com o nome de &lt;strong&gt;rc.asterisk&lt;/strong&gt;, dê permissão de execução e copie para&lt;br&gt;o diretório no diretório &lt;strong&gt;/etc/rc.d&lt;/strong&gt;, e podemos inicializá-lo pela primeira vez:&lt;/p&gt;
&lt;p style="text-align: left;"&gt;&lt;br&gt;&lt;strong&gt;root@host# chmod +x rc.asterisk&lt;br&gt;root@host# mv rc.asterisk /etc/rc.d&lt;br&gt;root@host# /etc/rc.d/rc.asterisk start&lt;/strong&gt;&lt;/p&gt;
&lt;p style="text-align: left;"&gt;&lt;strong&gt;&lt;br&gt;root#host# asterisk –vvvrcg&lt;br&gt;&lt;em&gt;Asterisk 1.6.1.1, Copyright (C) 1999 - 2008 Digium, Inc. and others.&lt;br&gt;Created by Mark Spencer &amp;lt;markster@digium.com&amp;gt;&lt;br&gt;Asterisk comes with ABSOLUTELY NO WARRANTY; type 'core show warranty' fordetails.&lt;br&gt;This is free software, with components licensed under the GNU General Public&lt;br&gt;License version 2 and other licenses; you are welcome to redistribute it under certain conditions. Type 'core show license' for details.&lt;br&gt;=========================================================================&lt;br&gt;== Parsing '/etc/asterisk/asterisk.conf': == Found&lt;br&gt;== Parsing '/etc/asterisk/extconfig.conf': == Found&lt;br&gt;Connected to Asterisk 1.6.1.1 currently running on chat (pid = 23082)&lt;br&gt;Verbosity is at least 5&lt;br&gt;-- Remote UNIX connection&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;br&gt;Pronto asterisk funcionado agora vamos fazer a configurações das contas voip, dentro de &lt;strong&gt;/etc/asterisk&lt;/strong&gt; encontram-se os arquivos de configuração.&lt;br&gt;O arquivo de configuração SIP - &lt;strong&gt;extensions.conf&lt;/strong&gt;&lt;br&gt;O arquivo &lt;strong&gt;extensions.conf &lt;/strong&gt;é o responsável por criar as extensões ou ramais, nele criamos também caminhos genéricos como &lt;strong&gt;XXX&lt;/strong&gt; para cada &lt;strong&gt;X&lt;/strong&gt; um dígito, onde podemos usar a imaginação para solucionar as questões que precisamos.&lt;br&gt;No &lt;strong&gt;extensions.conf&lt;/strong&gt; criamos grupos de chamadas locais no qual podemos incluir outros grupos e criar os ramais dentro dele. Abaixo temos um exemplo de configuração do grupo de chamada&lt;strong&gt; 'grupo1'&lt;/strong&gt; que inclui os ramais do grupo &lt;strong&gt;'demo' &lt;/strong&gt;e contém os seguintes ramais. Os comentários deste arquivo são precedidos de &lt;strong&gt;" ; "&lt;/strong&gt;.&lt;/p&gt;
&lt;p style="text-align: left;"&gt;&lt;br&gt;Veja que no contexto &lt;strong&gt;[interno]&lt;/strong&gt; incluímos o contexto &lt;strong&gt;[demo]&lt;/strong&gt; e criamos&lt;br&gt;dois ramais&lt;strong&gt; (1000,1001)&lt;/strong&gt;.&lt;/p&gt;
&lt;p style="text-align: left;"&gt;&lt;br&gt;&lt;strong&gt;[interno]&lt;br&gt;include =&amp;gt; demo&lt;br&gt;; Configuração do SIP&lt;br&gt;exten =&amp;gt; 1000,1,Dial(SIP/1000,25)&lt;br&gt;#; SIP-É o tipo da conta / 1000 / 25-O tempo que vai&lt;br&gt;chamar em segundos.&lt;br&gt;exten =&amp;gt; 1000,2,Hangup&lt;br&gt;exten =&amp;gt; 1001,1,Dial(SIP/1001,25)&lt;br&gt;exten =&amp;gt; 1001,2,Hangup&lt;/strong&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;O arquivo de configuração SIP -&lt;strong&gt; sip.conf&lt;/strong&gt;&lt;br&gt;O arquivo&lt;strong&gt; sip.conf&lt;/strong&gt; armazena informações sobre contas de usuários de protocolo SIP as informações são simples como nome de usuário, bina, senha e qual grupo participam.&lt;br&gt;No exemplo abaixo estamos criando os usuários que receberam um número no &lt;strong&gt;extensions.conf&lt;/strong&gt;.&lt;/p&gt;
&lt;p style="text-align: left;"&gt;&lt;br&gt;&lt;strong&gt;[general]&lt;em&gt; ; configurações básicas do protocolo&lt;/em&gt;&lt;br&gt;context=default ; Context padrão para recebimento de chamadas&lt;br&gt;bindport=5060 ; Porta UDP (A padrão é 5060)&lt;br&gt;bindaddr=0.0.0.0; Endereço IP para escutar (0.0.0.0 Escuta todas&lt;br&gt;interfaces)&lt;br&gt;;Codec&lt;br&gt;allow=ulaw&lt;br&gt;allow=alaw&lt;br&gt;allow=g729&lt;br&gt;allow=ilbc&lt;br&gt;allow=h263&lt;br&gt;allow=h263p&lt;br&gt;language=pt_BR ;Lingua padão&lt;br&gt;videosupport=Yes; Suporte a video&lt;br&gt;textsupport=Yes; Suporte a texto&lt;br&gt;#################################################################&lt;br&gt;# * Friend = Efetua e recebe ligações;&lt;br&gt;# * Peer = Apenas faz ligações;&lt;br&gt;# * User = Apenas recebe ligações.&lt;br&gt;################################################################&lt;br&gt;[1000]&lt;br&gt;type=friend ; tipo friend=faz e recebe chamadas, user=faz chamadas,&lt;br&gt;peer=recebe chamadas.&lt;br&gt;callerid = "ADMIN" &amp;lt;1000&amp;gt;&lt;br&gt;username=1000 ;Nome do usuário para login&lt;br&gt;secret=123 ; Senha&lt;br&gt;host= dynamic ; se não tem ip fixo&lt;br&gt;nat=yes ; se está debaixo de nat&lt;br&gt;canreinvite=no ; no para não encaminhar chamadas&lt;br&gt;context=interno ; Context padrão para recebimento de chamadas&lt;br&gt;qualify=yes ; verifica se o host está respondendo (está a menos de 20ms)&lt;br&gt;allow=all&lt;br&gt;[1001]&lt;br&gt;type=friend&lt;br&gt;callerid = "Diego" &amp;lt;1001&amp;gt;&lt;br&gt;username=1001&lt;br&gt;secret=123&lt;br&gt;host= dynamic&lt;br&gt;nat=yes&lt;br&gt;canreinvite=no&lt;br&gt;context=interno&lt;br&gt;qualify=yes&lt;br&gt;allow=all&lt;/strong&gt;&lt;/p&gt;
&lt;p style="text-align: left;"&gt;Após as alterações reinicie o asterisk e vamos verificar as contas:&lt;/p&gt;
&lt;p style="text-align: left;"&gt;&lt;br&gt;&lt;strong&gt;root@host# /etc.rc.d/rc.asterisk restart&lt;br&gt;root@host# asterisk –vvvvrcg&lt;br&gt;chat*CLI&amp;gt; sip show peers&lt;br&gt;Name/username Host Dyn Nat ACL Port Status&lt;br&gt;1000/1000 201.91.215.132 D N 5061 OK (166 ms)&lt;br&gt;1001/1001 201.91.215.132 D N 61836 OK (134 ms)&lt;/strong&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Bom essa contas já estão conectadas e respondendo ao ping do asterisk, eu as autentiquei em um softphone e estão em perfeito funcionamento agora vamos vinculá-las e cotas de usuários do OpenFire. Com o Openfire abeto vá a guia Plugins e Plugins Disponiveis e instale&lt;br&gt;o plugin &lt;strong&gt;"SIP Phone Plugin"&lt;/strong&gt;:&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;img src="/articles/0013/9354/sipphone.jpg1256730148" height="72" alt="Sipphone" width="748"&gt;&lt;/p&gt;
&lt;p style="text-align: left;"&gt;&lt;img alt=""&gt;&lt;img alt=""&gt;&lt;/p&gt;
&lt;p style="text-align: left;"&gt;Depois de instalado vamos a guia Servidor, Telefone, Ajustar SIP:&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;img src="/articles/0013/9353/sip-config.jpg1256730147" height="355" alt="Sip_config" width="747"&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Aqui é onde faremos as configurações do servidor Sip Asterisk que configuramos colocarmos o IP ou hostname do servidor se ele tiver correio de voz colocaremos o IP dele novamente se terá suporte a STUN, IP do servidor STUN e sua porta, depois é só clicar em&lt;strong&gt; "Atualizar&lt;br&gt;Configurações".&lt;/strong&gt;&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;span style="font-size: medium;"&gt;&lt;span style="text-decoration: underline;"&gt;&lt;strong&gt;O que é um servidor STUN?&lt;/strong&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;O STUN (Simple Traversal of User Datagram Protocol [UDP], por meio da Network Address Translators [NATs]), é um servidor que permite que clientes NAT (ex.: computadores protegidos por firewall) realizem chamadas telefônicas a um provedor VoIP que se encontre fora da rede local.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;O servidor STUN permite que os clientes descubram seu endereço público, o tipo de NAT utilizado, e o lado da porta da Internet associada à NAT com uma porta local específica. Essas informações são usadas para permitir a comunicação UDP entre o cliente e o provedor VoIP, e então, estabelecer a chamada. O protocolo STUN é definido pela RFC 3489.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;O servidor STUN está ligado à porta UDP 3478. No entanto, o servidor irá sugerir aos clientes que realizem testes em IPs e números de portas alternativos (os servidores STUN têm dois endereços IP). O RFC determina que tanto portas como IPs podem ser usados (de acordo com a preferência do cliente).&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;br&gt;&lt;strong&gt;Fonte: http://www.3cx.com.br/voip-sip/stun-server.php&lt;/strong&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;br&gt;Depois de configurado o servidor vamos veicular nossa contas de usuários aos números voip, vá à guia &lt;strong&gt;"Mapeamento de Telefones SIP"&lt;/strong&gt;, logo abaixo terá &lt;strong&gt;"Add new Phone Mapping"&lt;/strong&gt;, para adicionarmos a primeira conta vamos supor que temos cadastrados os usuário:&lt;strong&gt;"admin e diego"&lt;/strong&gt;, vamos adiciona uma conta para cada um.&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;img src="/articles/0013/9350/conta1.jpg1256730141" height="389" alt="Conta1" width="683"&gt;&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;img src="/articles/0013/9351/conta2.jpg1256730143" height="442" alt="Conta2" width="674"&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;No usuário &lt;strong&gt;"XMMP username" &lt;/strong&gt;é onde colocarmos o login do cliente, &lt;strong&gt;"SIP username"&lt;/strong&gt; é a conta VOIP,&lt;strong&gt; "Nome de Autenticação"&lt;/strong&gt; é o login para autenticar no SIP, &lt;strong&gt;"Mostra Nome"&lt;/strong&gt; é um nome de apresentação só, &lt;strong&gt;"Senha" &lt;/strong&gt;a senha definida no SIP Server, os outros atributos já são colocados por Default, pois já foram configurados&lt;strong&gt; "Ajustes SIP"&lt;/strong&gt;.&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;img src="/articles/0013/9352/mapas.jpg1256730145" height="274" alt="Mapas" width="645"&gt;&lt;/p&gt;
&lt;p style="text-align: left;"&gt; &lt;/p&gt;
&lt;p style="text-align: justify;"&gt; &lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Agora iremos configurar o cliente para utilizar o serviço, iremos utilizar o &lt;strong&gt;"SPARK"&lt;/strong&gt;, podemos baixar o spark em &lt;strong&gt;"http://www.igniterealtime.org"&lt;/strong&gt;, depois de instalado o cliente iremos&lt;br&gt;configurar a conta do cliente:&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;img src="/articles/0013/9355/spark1.jpg1256730149" height="530" alt="Spark1" style="float: left;" width="295"&gt;&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;img src="/articles/0013/9356/spark2.jpg1256730150" height="532" alt="Spark2" width="293"&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Agora iremos instalar o plugin &lt;strong&gt;"Phone Client"&lt;/strong&gt;, vá a guia &lt;strong&gt;"Spark-&amp;gt; Plugins -&amp;gt; Plugins Disponíveis"&lt;/strong&gt;, ele irá buscar todos os plugins disponíveis, instale o &lt;strong&gt;"Phone Client",&lt;/strong&gt; feche e abra o programa.&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;img src="/articles/0013/9357/spark3.jpg1256730151" height="466" alt="Spark3" width="290"&gt;&lt;/p&gt;
&lt;p style="text-align: left;"&gt;Configure a outra conta em outra maquina e podemos fazer um teste de discagem digite o ramal &lt;strong&gt;"1001"&lt;/strong&gt; e aperte&lt;strong&gt; "ENTER"&lt;/strong&gt;. Pronto está funcionando.&lt;/p&gt;
&lt;p style="text-align: left;"&gt;Fontes interessantes de Pesquisa:&lt;/p&gt;
&lt;p style="text-align: left;"&gt;&lt;br&gt;&lt;em&gt;&lt;strong&gt;http://www.fug.com.br/content/view/101/9/1/1/&lt;br&gt;http://www.fug.com.br/content/view/112/9/&lt;br&gt;http://www.3cx.com.br/voip-sip/stun-server.php&lt;br&gt;http://www.asterisk.org&lt;br&gt;http://www.vivaolinux.com.br/artigo/Asterisk-O-PBX-de-codigoaberto/?pagina=1&lt;/strong&gt;&lt;/em&gt;&lt;/p&gt;
&lt;p style="text-align: left;"&gt; &lt;/p&gt;</description><pubDate>Wed, 28 Oct 2009 07:51:17 +0000</pubDate><link>http://softwarelivre.org/dtux/blog/openfire-asterisk-interagindo-voip-com-seus-clientes-internos</link><guid>http://softwarelivre.org/dtux/blog/openfire-asterisk-interagindo-voip-com-seus-clientes-internos</guid></item><item><title>Instalação e Configuração do Samba4</title><description>&lt;p style="text-align: justify;"&gt; &lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;img src="http://www.bestlinux.com.br/images/stories/Imagens_Noticias2/logo_main.gif" height="122" alt="" width="271"&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #000000;"&gt;Em janeiro de 2006 foi lançando a primeira versão beta do samba4. Mesmo antes desta data várias informações já eram dadas sobre as características do novo “servidor de arquivo”. Uma das informações que mais chama a nossa atenção era sobre a integração do SAMBA com o AD.&lt;br&gt; Agora com a versão ALPHA 9 já podemos testar e verificar as principais características do SAMBA4.&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #000000;"&gt;Softwares utilizados:&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;strong&gt;•	Linux: Slackware 12.2 – Current Version&lt;/strong&gt;&lt;br&gt; ftp://ftp.slackware.no/pub/linux/ISO-images/slackware/13.0/&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;strong&gt;•	PhpLDAPadmin 1.1.0.7&lt;/strong&gt;&lt;br&gt; http://phpldapadmin.sourceforge.net/&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;strong&gt;•	Samba 4 Alpha9&lt;/strong&gt;&lt;br&gt; Via Git: “git clone git://git.samba.org/samba.git samba-master; cd samba-master &amp;amp;&amp;amp; git checkout -b master origin/master; cd ..”&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;strong&gt;•	Heimdal Kerberos&lt;/strong&gt;&lt;br&gt; http://www.h5l.org/dist/src/heimdal-1.2.1.tar.gz&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;strong&gt;•	Bind 9&lt;/strong&gt;&lt;br&gt; ftp://ftp.isc.org/isc/bind9/9.5.2/bind-9.5.2.tar.gz&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;span style="text-decoration: underline;"&gt;&lt;span style="color: #000000;"&gt;&lt;strong&gt;Dependências de Outros softwares para o perfeito funcionamento&lt;/strong&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Para o perfeito funcionamento do Samba4 depois vários testes foi visto que o DNS é um dos requisito primordiais para seu funcionamento adequado e reconhecimento de algumas diretivas impostas pelo samba4, para isso recopilaremos o BIND com suporte a Heimdal Kerberos, existem duas implementações de código aberto do Kerberos: Heimdal e MIT Kerberos. Heimdal é uma implementação do protocolo Kerberos implementada pela KTH (Royal Institute of Technology, em Estocolmo), enquanto MIT Kerberos é fornecido pelo MIT (Massachussets Institute of Technology), como diz seu nome.&lt;br&gt; Autenticação Kerberos é um protocolo de rede. Foi concebido para fornecer autenticação forte para o cliente/servidores de aplicativos usando criptografia de chaves secretas, então um cliente pode provar a sua identidade para um servidor (e vice-versa) em uma conexão de rede insegura.&lt;br&gt; Em nosso caso utilizaremos BIND com suporte ao Heimdal Kerberos por causa do GSS-TSIG algoritmo de serviço de segurança genérico para autenticação de transação com chave secreta de DNS (GSS-TSIG) este mecanismo é utilizado para estabelecer relações TSIG para autenticação do tipo Kerberos, necessário para interagir BIND com Samba4, com essas credenciais o DNS aceita atualizações GSS-TSIG assinadas e verifica as credenciais de correspondentes com as credencias cadastradas no Samba4, isso permite aos usuários descarregar o DNS dos usuários do Microsoft Windows sem ter a segurança comprometida.&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;span style="text-decoration: underline;"&gt;&lt;strong&gt;Compilação e Instalação&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Começaremos pelo Heimdal:&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;strong&gt;&lt;span style="color: #808080;"&gt;#tar –zxvf heimdal-1.2.1.tar.gz&lt;br&gt; #cd heimdal-1.2.1&lt;br&gt; #./configure –prefix=/usr –libdir=/usr/lib \&lt;br&gt; –sysconfdir=/etc  –localstatedir=/var  \&lt;br&gt; –mandir=/usr/man –with-openssl=/usr –bindir=/usr/bin/ \&lt;br&gt; –sbindir=/usr/sbin/ –enable-kcm&lt;br&gt; #make &amp;amp;&amp;amp; make install&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #000000;"&gt;Criaremos o usuário e o grupo responsável pelo Bind, e efetuaremos a compilação:&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;strong&gt;&lt;span style="color: #808080;"&gt;# groupadd named &amp;amp;&amp;amp; useradd named –g named&lt;br&gt; #tar –zxvf bind-9.5.2.tar.gz&lt;br&gt; #cd bind-9.5.2&lt;br&gt; #./configure   –prefix=/usr   –libdir=/usr/lib  \&lt;br&gt; –sysconfdir=/etc –localstatedir=/var   –with-libtool   \&lt;br&gt; –mandir=/usr/man   –enable-shared   –disable-static   \&lt;br&gt; –enable-threads –with-openssl=/usr –with-gssapi=/usr/include/gssapi –bindir=/usr/bin/ –sbindir=/usr/sbin/&lt;br&gt; #make &amp;amp;&amp;amp; make install&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #000000;"&gt;Adicione seu host em&lt;em&gt;&lt;strong&gt; “/etc/hosts”&lt;/strong&gt;&lt;/em&gt;, para ajudar 	na resolução de nomes, em meu caso ficou deste modo:&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #808080;"&gt;&lt;strong&gt;#vi /etc/hosts&lt;/strong&gt;&lt;/span&gt;&lt;span style="color: #808080;"&gt;&lt;strong&gt; &lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #808080;"&gt;&lt;strong&gt;127.0.0.1                                       localhost&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;strong&gt;&lt;span style="color: #808080;"&gt;192.168.11.1                              dtux.org dtux&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #000000;"&gt;Testando o funcionamento do Bind:&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;strong&gt;&lt;span style="color: #808080;"&gt;#named –u named -g&lt;br&gt; 25-Sep-2009 11:00:21.348 zone dtux.org/IN: loaded serial 2009091112&lt;br&gt; 25-Sep-2009 11:00:21.350 running&lt;br&gt; 25-Sep-2009 11:00:21.350 zone dtux.org/IN: sending notifies (serial 2009091112)&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;strong&gt;&lt;span style="text-decoration: underline;"&gt;Compilação&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #000000;"&gt;Após fazer o download, foi criado um diretório chamando samba-master. Os fontes do SAMBA4 ficaram dentro do diretório source4, criaremos um link simbólico apontando para source.&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;strong&gt;&lt;span style="color: #808080;"&gt;# cd samba-master/&lt;br&gt; # ln –s source4 source&lt;br&gt; # cd source&lt;br&gt; #./autogen.sh&lt;br&gt; #./configure –prefix=/usr/local/samba –sysconfdir=/etc/ –localstatedir=/var –mandir=/usr/man/ –enable-fhs –enable-debug –bindir=/usr/bin –sbindir=/usr/sbin –libdir=/lib –enable-developer&lt;br&gt; # make &amp;amp;&amp;amp; make install&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #000000;"&gt;Após a instalação rode o utilitário provision para a criação do domínio e do usuário administrator e sua respectiva senha:&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;strong&gt;&lt;span style="color: #808080;"&gt;#./setup/provision –realm=DTUX.ORG –domain=DTUX –admin=anna –server-role=’domain controller’&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #000000;"&gt;O parâmetro&lt;strong&gt;&lt;em&gt; “–realm” &lt;/em&gt;&lt;/strong&gt;é para definir o domínio do servidor Kerberos e o&lt;em&gt;&lt;strong&gt; “domain”&lt;/strong&gt;&lt;/em&gt; para o domínio SAMBA.&lt;br&gt; O SAMBA4 trás embutido os protocolos:&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;strong&gt;DNS – ( Bind )&lt;br&gt; SMB-( Samba 3 )&lt;br&gt; LDAP( OpenLdap )&lt;br&gt; KERBEROS( Heimdal )&lt;br&gt; MS-RPC – ( GPO )&lt;/strong&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #000000;"&gt;Credenciais Utilizando base SamDB&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #000000;"&gt;… que são responsáveis pela autenticação Active Directory.&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #000000;"&gt;O diretório &lt;em&gt;&lt;strong&gt;“/usr/local/samba”&lt;/strong&gt;&lt;/em&gt; é gerado pela compilação do SAMBA e tem os seguintes subdiretórios:&lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span style="color: #000000;"&gt;&lt;strong&gt;/usr/bin:  Programas para gerenciamento do samba, tais como smbstatus, net, etc.&lt;/strong&gt;&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&lt;span style="color: #000000;"&gt;&lt;strong&gt;/usr/sbin: Programa responsável por inicializar o samba.&lt;/strong&gt;&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&lt;span style="color: #000000;"&gt;&lt;strong&gt;/etc/samba:  Neste diretório fica o arquivo de configuração smb.conf&lt;/strong&gt;&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&lt;span style="color: #000000;"&gt;&lt;strong&gt;/usr/lib: Todas as libs compiladas do samba&lt;/strong&gt;&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&lt;span style="color: #000000;"&gt;&lt;strong&gt; /var/lib/samba/private: Exemplos de arquivos de configuração&lt;/strong&gt;&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p style="text-align: center;"&gt;&lt;span style="color: #000000;"&gt;&lt;strong&gt;&lt;span style="text-decoration: underline;"&gt;Configuração do Bind&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #000000;"&gt;Após a instalação, configuramos o servidor DNS para trabalhar juntamente com o KERBEROS e KERBERO com BIND. Utilize os arquivos exemplos gerados pelo próprio SAMBA que estão dentro do diretório&lt;em&gt;&lt;strong&gt; “/var/lib/samba/private”&lt;/strong&gt;&lt;/em&gt;. Edite o arquivo &lt;strong&gt;&lt;em&gt;“/etc/named/named.conf”&lt;/em&gt;&lt;/strong&gt;&lt;strong&gt;&lt;em&gt; &lt;/em&gt;&lt;/strong&gt;adicione as seguintes linhas:&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;strong&gt;&lt;span style="color: #808080;"&gt;#vi /etc/named/named.conf&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #000000;"&gt;Na sessão&lt;em&gt;&lt;strong&gt; “option{}”&lt;/strong&gt;&lt;/em&gt; adicione as linhas que irão fazer a comunicação ente o Keberos e o Bind:&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;strong&gt;&lt;span style="color: #808080;"&gt;options{&lt;br&gt; directory “/var/named”;&lt;br&gt; tkey-gssapi-credential “DNS/dtux.org”;&lt;br&gt; tkey-domain “DTUX.ORG”;&lt;br&gt; }&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #000000;"&gt;Depois de configurado a sessão &lt;em&gt;&lt;strong&gt;“options”&lt;/strong&gt;&lt;/em&gt; incluiremos o arquivo &lt;em&gt;&lt;strong&gt;“named.conf”&lt;/strong&gt;&lt;/em&gt; do Samba4 no Bind, abaixo da sessão &lt;em&gt;&lt;strong&gt;“options”&lt;/strong&gt;&lt;/em&gt; adicione:&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #808080;"&gt;&lt;strong&gt;options{&lt;br&gt; directory “/var/named”;&lt;br&gt; tkey-gssapi-credential “DNS/dtux.org”;&lt;br&gt; tkey-domain “DTUX.ORG”;&lt;br&gt; }&lt;br&gt; include “/var/lib/samba/private/named.conf”;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #000000;"&gt;Nesse arquivo está a configuração a zona configurada pelo Samba4 quando foi utilizado o utilitário&lt;em&gt;&lt;strong&gt; “provision”&lt;/strong&gt;&lt;/em&gt;. Antes de testar o funcionamento do Bind, temos que setar as variáveis de localização do arquivo&lt;em&gt;&lt;strong&gt; “dns.keytab”&lt;/strong&gt;&lt;/em&gt;, que é onde estão as informações de DNS registradas pelo Samba4:&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;strong&gt;&lt;span style="color: #808080;"&gt;# KEYTAB_FILE=“/var/lib/samba/private/dns.keytab”&lt;br&gt; # export KRB5_KTNAME=“/var/lib/samba/private/dns.keytab”&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #000000;"&gt;Para não termos que ficar digitando essas linhas a todo o momento coloquemos elas no inicio do arquivo&lt;em&gt;&lt;strong&gt; “/etc/rc.d/rc.bind”&lt;/strong&gt;&lt;/em&gt;, responsável pela inicialização do daemon do named.&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;strong&gt;&lt;span style="color: #808080;"&gt;#killall -9 named&lt;br&gt; #named –u named&lt;br&gt; #ps ax |grep named&lt;br&gt; 4450 ?        Ssl    0:00 named -u named&lt;br&gt; 4455 pts/3    R+     0:00 grep named&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #000000;"&gt;Pronto seu Bind já estará rodando e trocando informações com o Samba4, vamos fazer um teste para verificar se seu funcionamento está ok, utilizaremos a ferramenta&lt;em&gt;&lt;strong&gt; “nsloockup”&lt;/strong&gt;&lt;/em&gt;:&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;a href="http://samba4.wordpress.com/"&gt;&lt;img title="dns" class="size-medium wp-image-16 aligncenter" src="http://samba4.files.wordpress.com/2009/09/dns.jpeg?w=433&amp;amp;h=298" height="298" alt="dns" width="433"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt; &lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #000000;"&gt;Caso você queira configurar um DNS reverso para o IP de seu samba fica a seu critério.&lt;br&gt; Também copiaremos o arquivo &lt;em&gt;&lt;strong&gt;“krb5.conf”&lt;/strong&gt;&lt;/em&gt; que está em&lt;em&gt;&lt;strong&gt; “/var/lib/samba/private/“&lt;/strong&gt;&lt;/em&gt; para o diretório&lt;em&gt;&lt;strong&gt; “/etc/”&lt;/strong&gt;&lt;/em&gt;.&lt;br&gt; Por utilizar o Kerberos, é necessário que todas as máquinas envolvidas estejam com os mesmos horários (segundos).Para isso nada melhor do que setar o Samba para ser o nosso time server, adicione ao &lt;em&gt;&lt;strong&gt;“/etc/samba/smb.conf”&lt;/strong&gt;&lt;/em&gt; na sessão &lt;em&gt;&lt;strong&gt;“[globlas] “time server     = yes”&lt;/strong&gt;&lt;/em&gt;, nos cliente é só setar&lt;em&gt;&lt;strong&gt; “net time \dtux.org /set /Yes”&lt;/strong&gt;&lt;/em&gt;, que o horário ficará sincronizado o com o do servidor.&lt;br&gt; Acerte o sistema de arquivo para trabalhar com o&lt;em&gt;&lt;strong&gt; “xattr”&lt;/strong&gt;&lt;/em&gt; alterando o arquivo&lt;strong&gt;&lt;em&gt; “/etc/fstab”.&lt;/em&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #888888;"&gt;&lt;br&gt; &lt;strong&gt;/dev/sda1         ext3    defaults,user_xattr        0          1&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #000000;"&gt;Remonte o sistema para ativar as alterações.&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;strong&gt;&lt;span style="color: #888888;"&gt;# mount -o remount,rw /&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #000000;"&gt;Para testar, criemos alguns compartilhamentos. Para isso edite o arquivo &lt;em&gt;&lt;strong&gt;“smb.conf”&lt;/strong&gt;&lt;/em&gt; que está dentro do diretório&lt;em&gt;&lt;strong&gt; “/etc/samba/”.&lt;/strong&gt;&lt;/em&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;strong&gt;&lt;span style="color: #888888;"&gt;[profiles]&lt;br&gt; comment = Profiles Remotos&lt;br&gt; path = /home/profiles&lt;br&gt; read only = no&lt;br&gt; browseable = no&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #000000;"&gt;O compartilhamento &lt;em&gt;&lt;strong&gt;“Profiles”&lt;/strong&gt;&lt;/em&gt; indica a localização dos profiles dos usuários nesse caso se tratando de uma configuração para&lt;strong&gt;&lt;em&gt; “Perfil Móvel(Roaming Profile)”&lt;/em&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #000000;"&gt;Agora testaremos alguns serviços e verificar se estão todos funcionais.&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #000000;"&gt;Iniciando do Samba&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;strong&gt;&lt;span style="color: #888888;"&gt;#samba -i -M single&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #000000;"&gt;Iniciando o Samba em modo debug:&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;strong&gt;&lt;span style="color: #888888;"&gt;#samba -i -M single –d3&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #000000;"&gt;Inicialização do Bind:&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;strong&gt;&lt;span style="color: #888888;"&gt;#/etc/rc.d/rc.bind start&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #000000;"&gt;Pronto com isso no servidor já está no ar com DNS funcionado, vamos a alguns testes:&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #000000;"&gt;&lt;strong&gt;&lt;span style="text-decoration: underline;"&gt;Samba4&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #000000;"&gt;Autentique algum usuário do Samba4 com:&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;strong&gt;&lt;span style="color: #808080;"&gt;# smbclient //dtux.org/profiles -Uadministrator%anna&lt;br&gt; smb: \&amp;gt; dir&lt;br&gt; .                              D                             0                                       Wed Sep 23 11:31:36 2009&lt;br&gt; ..                             D                           0                                       Tue Sep 22 17:26:38 2009&lt;br&gt; Admin                                   D                               0            Tue Sep 22 15:28:02 2009&lt;br&gt; alexandro   D                         0            Tue Sep 22 17:19:31 2009&lt;br&gt; diego                                       D                         0            Mon Sep 21 16:42:47 2009&lt;br&gt; nazir                                        D                                0            Wed Sep 23 11:31:36 2009&lt;br&gt; danilo                                    D                         0            Tue Sep 22 12:04:42 2009&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #000000;"&gt;&lt;span style="text-decoration: underline;"&gt;&lt;strong&gt;Kerberos&lt;/strong&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #000000;"&gt;Autentique algum usuário do Samba4 com e ofereça a senha quando pedido:&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;strong&gt;&lt;span style="color: #808080;"&gt;#kinit administrator@DTUX.ORG&lt;br&gt; Password for administrator@DTUX.ORG:&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #000000;"&gt;Verificando os tickets de conexão:&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;strong&gt;&lt;span style="color: #808080;"&gt;#klist&lt;br&gt; Ticket cache: FILE:/tmp/krb5cc_0&lt;br&gt; Default principal: administrator@DTUX.ORG&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;strong&gt;&lt;span style="color: #808080;"&gt;Valid starting     Expires            Service principal&lt;br&gt; 09/25/09 14:22:50  09/26/09 14:22:48  krbtgt/DTUX.ORG@DTUX.ORG&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #000000;"&gt;Verificando os tickets de conexão e os métodos de autenticação aplicados&lt;/span&gt;:&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;strong&gt;&lt;span style="color: #808080;"&gt;#klist -e&lt;br&gt; Ticket cache: FILE:/tmp/krb5cc_0&lt;br&gt; Default principal: administrator@DTUX.ORG&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;strong&gt;&lt;span style="color: #808080;"&gt;Valid starting     Expires            Service principal&lt;br&gt; 09/25/09 14:22:50  09/26/09 14:22:48  krbtgt/DTUX.ORG@DTUX.ORG&lt;br&gt; Etype (skey, tkt): ArcFour with HMAC/md5, ArcFour with HMAC/md5&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;strong&gt;&lt;span style="color: #808080;"&gt;&lt;br&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;span style="color: #000000;"&gt;&lt;span style="text-decoration: underline;"&gt;&lt;strong&gt;Windows sendo Dominado pelo Samba4&lt;/strong&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #000000;"&gt;Para colocar o Windows XP no domínio do samba, além da configuração de hora já foi falado, devemos configurar o ip da máquina onde está o samba4 no DNS do micro com Windows XP/2003/2008/7.&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;span style="color: #000000;"&gt;&lt;a href="http://samba4.wordpress.com/2009/09/25/instalacao-samba4/dns21/"&gt;&lt;img title="dns21" class="size-full wp-image-21 aligncenter" src="http://samba4.files.wordpress.com/2009/09/dns21.jpg?w=495&amp;amp;h=371" height="371" alt="dns21" width="495"&gt;&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;span style="color: #000000;"&gt;&lt;br&gt; &lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #000000;"&gt;No Windows XP segue as seguintes configurações para se entrar em domínio, este procedimento serve para Windows XP/2000/2003/2008/7:&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #000000;"&gt;&lt;em&gt;&lt;strong&gt;•	Menu Iniciar -&amp;gt; Painel de Controle -&amp;gt; Sistema&lt;br&gt; •	Guia “Nome do Computador”&lt;br&gt; •	Alterar&lt;br&gt; •	Marque o checkbox “Domínio”&lt;br&gt; •	Coloque o seu domínio (DTUX.ORG) -&amp;gt; OK&lt;br&gt; • Caso ocorrer algum problema de apontamento de DN, pode-se editar o arquivo “C:\WINDOWS\system32\drivers\etc\hosts”, no arquivo “hosts” você coloca o IP do servidor samba e na frente o seu respectivo DNS name desta forma:&lt;/strong&gt;&lt;/em&gt;&lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt; &lt;strong&gt;&lt;span style="color: #808080;"&gt;127.0.0.1         localhost&lt;/span&gt;&lt;/strong&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;span style="color: #808080;"&gt; 192.168.11.2   	 dtux.org dtux&lt;/span&gt;&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p style="text-align: center;"&gt;&lt;a href="http://samba4.wordpress.com/2009/09/25/instalacao-samba4/logon-2/"&gt;&lt;img title="logon" class="aligncenter size-full wp-image-23" src="http://samba4.files.wordpress.com/2009/09/logon1.jpg?w=495&amp;amp;h=309" height="309" alt="logon" width="495"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;a href="http://samba4.wordpress.com/2009/09/25/instalacao-samba4/logon1/"&gt;&lt;img title="logon1" class="aligncenter size-full wp-image-24" src="http://samba4.files.wordpress.com/2009/09/logon11.jpg?w=501&amp;amp;h=312" height="312" alt="logon1" width="501"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #000000;"&gt;Simple no primeiro logon logue como administrator, caso você queira fazer parte da administração do Samba4 através do &lt;strong&gt;&lt;em&gt;“Windows Server 2003 Administration Tools Pack” &lt;/em&gt;&lt;/strong&gt;antes de instalá-lo, instale o&lt;strong&gt;&lt;em&gt; “Windows Server 2003 Suporte Tools”&lt;/em&gt;&lt;/strong&gt;:&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;•&lt;strong&gt;&lt;span style="color: #808080;"&gt; http://www.microsoft.com/downloads/details.aspx?FamilyID=c16ae515-c8f4-47ef-a1e4-a8dcbacff8e3&amp;amp;displaylang=en &lt;/span&gt;&lt;/strong&gt;&lt;br&gt; •&lt;strong&gt; &lt;span style="color: #808080;"&gt;http://download.microsoft.com/download/3/e/4/3e438f5e-24ef-4637-abd1-981341d349c7/WindowsServer2003-KB892777-SupportTools-x86-ENU.exe&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #000000;"&gt;Aproveitando vamos criar um &lt;strong&gt;&lt;em&gt;“Perfil Remoto”&lt;/em&gt;&lt;/strong&gt;, um problema encontrado com perfil remoto foi encontrado quando você cria um usuário pelo&lt;strong&gt;&lt;em&gt; “Administrator Tolls”&lt;/em&gt;&lt;/strong&gt; esse usuário não terá acesso ao Shell do Linux e com isso ele não irá conseguir ditar permissões de escrita e leitura, a forma existe script na pasta:&lt;/span&gt;&lt;strong&gt;&lt;em&gt;&lt;span style="color: #808080;"&gt;&lt;span style="color: #000000;"&gt; /usr/local/samba/share/samba/setup&lt;/span&gt;/&lt;/span&gt;.&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #808080;"&gt;&lt;strong&gt;•	newuser&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #000000;"&gt;Antes de utilizá-lo você tem que adicionar o usuário no Linux usando o comando comum&lt;strong&gt;&lt;em&gt; “useradd”&lt;/em&gt;&lt;/strong&gt;.&lt;br&gt; Iremos simular o seguinte ambiente, criaremos um grupo e adicionaremos um usuário no Linux a colocaremos esse usuário no grupo criado entre no &lt;strong&gt;&lt;em&gt;“Administrator Tools”&lt;/em&gt;&lt;/strong&gt;, criaremos o grupo também e utilizaremos o script &lt;strong&gt;&lt;em&gt;“newuser”&lt;/em&gt;&lt;/strong&gt; para adicionar o usuário no samba4.&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #000000;"&gt;•	Criando grupo:&lt;/span&gt;&lt;br&gt; &lt;strong&gt;&lt;span style="color: #808080;"&gt;#groupadd samba4&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;•&lt;span style="color: #000000;"&gt; Criando usuário no Linux:&lt;/span&gt;&lt;br&gt; &lt;strong&gt;&lt;span style="color: #808080;"&gt;#useradd teste –g samba4 -p senha –c “Teste Samba4 Users”&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;•	Criando a pasta do profile do usuário, levando em consideração que&lt;strong&gt;&lt;em&gt; “/home/profiles”&lt;/em&gt;&lt;/strong&gt;, já foi feito acima:&lt;br&gt; &lt;strong&gt;&lt;span style="color: #808080;"&gt;#mkdir -p /home/profiles/teste&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #000000;"&gt;•	Ditando permissões de acesso a pasta para este usuário recém criado:&lt;/span&gt;&lt;br&gt; &lt;span style="color: #808080;"&gt;&lt;strong&gt; #chown teste:samba4 /home/profiles/teste&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #000000;"&gt;Agora usaremos o script &lt;em&gt;&lt;strong&gt;“newuser”&lt;/strong&gt;&lt;/em&gt; para fazer a importação, um problema encontrado foram as bibliotecas python utilizadas por esse scripts elas estão localizadas em&lt;em&gt;&lt;strong&gt; “/usr/local/samba/lib/python2.6/site-packages”&lt;/strong&gt;&lt;/em&gt;, temos que copiar todo esses arquivos para a pasta real do python do sistema &lt;em&gt;&lt;strong&gt;“/usr/lib/python2.6/site-packages/”&lt;/strong&gt;&lt;/em&gt;:&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;strong&gt;&lt;span style="color: #808080;"&gt;#cd /usr/local/samba/lib/python2.6/site-packages&lt;br&gt; #cp –rp  *  /usr/lib/python2.6/site-packages/&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #000000;"&gt;Vamos fazer a copia do&lt;em&gt;&lt;strong&gt; “newuser”&lt;/strong&gt;&lt;/em&gt; para nosso diretório&lt;strong&gt;&lt;em&gt; “/usr/sbin”&lt;/em&gt;&lt;/strong&gt;:&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;strong&gt;&lt;span style="color: #808080;"&gt; #cp /usr/local/samba/share/samba/setup/newuser /usr/sbin&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #000000;"&gt;Tudo pronto para a execução do script:&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;strong&gt;&lt;span style="color: #808080;"&gt; #newuser teste senha –unixname=teste -k KERBEROS –workgroup=dtux.org&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;strong&gt;&lt;span style="color: #000000;"&gt;•	–unixname: Usuário criado no Linux/Unix&lt;br&gt; •	-k KERBEROS: Utiliza autenticação Kerberos&lt;br&gt; •	–workgroup: Domínio Criado&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #000000;"&gt;Agora quando você autenticar no Windows com este usuário que ele já está sincronizado, quando você abrir o&lt;em&gt;&lt;strong&gt; “Administrator Tools” pelo menu “Iniciar -&amp;gt; Executar”, digite “dsa.msc”&lt;/strong&gt;&lt;/em&gt;:&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;span style="color: #000000;"&gt;&lt;a href="http://samba4.wordpress.com/2009/09/25/instalacao-samba4/dsamsc1/"&gt;&lt;img title="dsamsc1" class="aligncenter size-full wp-image-25" src="http://samba4.files.wordpress.com/2009/09/dsamsc1.jpg?w=368&amp;amp;h=181" height="181" alt="dsamsc1" width="368"&gt;&lt;/a&gt;&lt;br&gt; &lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #000000;"&gt;Depois clique em seu domínio e vá em &lt;strong&gt;&lt;em&gt;“Users” &lt;/em&gt;&lt;/strong&gt;o usuário já irá aparecer na listagem, criaremos o grupo &lt;em&gt;&lt;strong&gt;“samba4”&lt;/strong&gt;&lt;/em&gt; pelo&lt;em&gt;&lt;strong&gt; “Administrator Tools” &lt;/strong&gt;&lt;/em&gt;e adicionaremos o usuário &lt;em&gt;&lt;strong&gt;“teste”&lt;/strong&gt;&lt;/em&gt; neste grupo, e configuraremos o seu profile remoto.&lt;br&gt; Criando o grupo:&lt;em&gt;&lt;strong&gt; “Botão direito em Builtin -&amp;gt;Novo -&amp;gt; Group”&lt;/strong&gt;&lt;/em&gt;, dê um nome uma descrição.&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;span style="color: #000000;"&gt;&lt;a href="http://samba4.wordpress.com/2009/09/25/instalacao-samba4/cgrupos/"&gt;&lt;img title="cgrupos" class="aligncenter size-full wp-image-28" src="http://samba4.files.wordpress.com/2009/09/cgrupos.jpg?w=495&amp;amp;h=272" height="272" alt="cgrupos" width="495"&gt;&lt;/a&gt;&lt;br&gt; &lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #000000;"&gt;Agora na guia &lt;em&gt;&lt;strong&gt;“Members”&lt;/strong&gt;&lt;/em&gt; você define os usuários que farão parte deste grupo.&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;span style="color: #000000;"&gt;&lt;a href="http://samba4.wordpress.com/2009/09/25/instalacao-samba4/cotactgrop/"&gt;&lt;img title="cotactgrop" class="aligncenter size-full wp-image-27" src="http://samba4.files.wordpress.com/2009/09/cotactgrop.jpg?w=495&amp;amp;h=272" height="272" alt="cotactgrop" width="495"&gt;&lt;/a&gt;&lt;br&gt; &lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #000000;"&gt;Os usuários que foi importamos já estão criados agora é só acertar alguns detalhes em &lt;em&gt;&lt;strong&gt;“User logon name”&lt;/strong&gt;&lt;/em&gt; que é o nome de logon é só colocar o nome do usuário e na frente o &lt;em&gt;&lt;strong&gt;“@DOMINIO”&lt;/strong&gt;&lt;/em&gt;, marque as opções&lt;em&gt;&lt;strong&gt; “Use cannot chance password”&lt;/strong&gt;&lt;/em&gt; se não quer que os usuários alterem a senha, e &lt;em&gt;&lt;strong&gt;“Password never expires”&lt;/strong&gt;&lt;/em&gt;, pra ela numca expirar.&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;span style="color: #000000;"&gt;&lt;a href="http://samba4.wordpress.com/2009/09/25/instalacao-samba4/configuracao-2/"&gt;&lt;img title="configuracao" class="aligncenter size-full wp-image-31" src="http://samba4.files.wordpress.com/2009/09/configuracao1.jpg?w=495&amp;amp;h=272" height="272" alt="configuracao" width="495"&gt;&lt;/a&gt;&lt;br&gt; &lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #000000;"&gt;Iremos agora á guia &lt;em&gt;&lt;strong&gt;“Profile”&lt;/strong&gt;&lt;/em&gt; e em &lt;em&gt;&lt;strong&gt;“Profile Path”&lt;/strong&gt;&lt;/em&gt; definiremos o caminho do diretório remoto onde serão armazenados os arquivos do usuário.&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;span style="color: #000000;"&gt;&lt;a href="http://samba4.wordpress.com/2009/09/25/instalacao-samba4/profile/"&gt;&lt;img title="profile" class="aligncenter size-full wp-image-32" src="http://samba4.files.wordpress.com/2009/09/profile.jpg?w=644&amp;amp;h=354" height="354" alt="profile" width="644"&gt;&lt;/a&gt;&lt;br&gt; &lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #000000;"&gt;Em &lt;em&gt;&lt;strong&gt;“Map Folder”&lt;/strong&gt;&lt;/em&gt;, podemos colocar esse caminho do profile do usuário para ser montado em uma unidade de mapeamento de rede.&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;span style="color: #000000;"&gt;&lt;a href="http://samba4.wordpress.com/2009/09/25/instalacao-samba4/mapeamento/"&gt;&lt;img title="mapeamento" class="aligncenter size-full wp-image-33" src="http://samba4.files.wordpress.com/2009/09/mapeamento.jpg?w=635&amp;amp;h=348" height="348" alt="mapeamento" width="635"&gt;&lt;/a&gt;&lt;br&gt; &lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #000000;"&gt;Podemos através do Windows os tickets do Kerberos através do&lt;em&gt;&lt;strong&gt; “Windows Server 2003 Resource Kit Tools”&lt;/strong&gt; (http://www.microsoft.com/downloads/details.aspx?familyid=9d467a69-57ff-4ae7-96ee-b18c4790cffd&amp;amp;displaylang=en)&lt;/em&gt;. Utilizaremos Klist e o Kerbtray, que ficam localizadas em: &lt;strong&gt;&lt;em&gt;“Iniciar -&amp;gt; Windows Resource Kit Tolls -&amp;gt; Command Shell”.&lt;/em&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;span style="color: #000000;"&gt;&lt;strong&gt;&lt;em&gt;&lt;a href="http://samba4.wordpress.com/2009/09/25/instalacao-samba4/resourcekit1/"&gt;&lt;img title="resourcekit1" class="aligncenter size-full wp-image-34" src="http://samba4.files.wordpress.com/2009/09/resourcekit1.jpg?w=495&amp;amp;h=371" height="371" alt="resourcekit1" width="495"&gt;&lt;/a&gt;&lt;br&gt; &lt;/em&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: center;"&gt; &lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;span style="color: #000000;"&gt;&lt;span style="text-decoration: underline;"&gt;&lt;strong&gt;Klist&lt;/strong&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #000000;"&gt;A ferramenta klist é uma ferramenta de linha de comando que permite que você exiba o conteúdo dos cache de credenciais e pode ser usada em um cliente Windows para exibir ou destruir credenciais existentes de Kerberos.&lt;br&gt; A ferramenta klist exige um argumento. O argumento&lt;span style="text-decoration: underline;"&gt;&lt;strong&gt; “tgt”&lt;/strong&gt;&lt;/span&gt; mostra as credenciais no cache atual, e o argumento&lt;span style="text-decoration: underline;"&gt;&lt;strong&gt; “tickets”&lt;/strong&gt;&lt;/span&gt; mostram as credenciais em cache.&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;span style="color: #000000;"&gt;&lt;a href="http://samba4.wordpress.com/2009/09/25/instalacao-samba4/klisttgt/"&gt;&lt;img title="klisttgt" class="aligncenter size-full wp-image-35" src="http://samba4.files.wordpress.com/2009/09/klisttgt.jpg?w=520&amp;amp;h=262" height="262" alt="klisttgt" width="520"&gt;&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;span style="color: #000000;"&gt;&lt;a href="http://samba4.wordpress.com/2009/09/25/instalacao-samba4/klisttickets/"&gt;&lt;img title="klisttickets" class="aligncenter size-full wp-image-36" src="http://samba4.files.wordpress.com/2009/09/klisttickets.jpg?w=521&amp;amp;h=262" height="262" alt="klisttickets" width="521"&gt;&lt;/a&gt;&lt;br&gt; &lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: center;"&gt; &lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;span style="color: #000000;"&gt;&lt;span style="text-decoration: underline;"&gt;&lt;strong&gt;KerbTray&lt;/strong&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #000000;"&gt;A ferramenta Kerberos Tray, KerbTray,&lt;strong&gt; (kerbtray.exe) &lt;/strong&gt;é uma ferramenta gráfica da plataforma Windows que exibe informações de tickets Kerberos em um computador de plataforma Windows onde os tickets Kerberos foram armazenados no cache de credenciais. Os tickets Kerberos são adquiridos e armazenados nas credenciais de cache quando um usuário autenticar em um computador de plataforma Windows (cliente ou servidor) como um usuário de domínio. O KerbTray permite que você visualize e limpe o cache de ticket.&lt;br&gt; Quando executado, a ferramenta coloca um ícone na bandeja do sistema. Esse ícone exibe o status com base na presença ou ausência de credenciais válidas. Dados disponibilizados pela interface KerbTray incluem os selos de tempo nos tickets, os marcadores associados às credenciais e o(s) tipo(s) de criptografia dos tickets.&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;span style="color: #000000;"&gt;&lt;a href="http://samba4.wordpress.com/2009/09/25/instalacao-samba4/kerbtraytickets/"&gt;&lt;img title="kerbtraytickets" class="aligncenter size-full wp-image-37" src="http://samba4.files.wordpress.com/2009/09/kerbtraytickets.jpg?w=583&amp;amp;h=436" height="436" alt="kerbtraytickets" width="583"&gt;&lt;/a&gt;&lt;br&gt; &lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #000000;"&gt;&lt;span style="text-decoration: underline;"&gt;&lt;strong&gt;Administração do Samba4 via phpLDAPadmin&lt;/strong&gt;&lt;/span&gt;&lt;br&gt; phpLDAPadmin é uma interface gráfica para gerenciar a base de dados LDAP. Para seu funcionamento será necessário ter instalação do Apache com suporte à PHP versão 5 ou 4 se preferir. O seu site oficial é (&lt;em&gt;http://phpldapadmin.sourceforge.net&lt;/em&gt;).&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;strong&gt;&lt;span style="color: #808080;"&gt;#wget –C http://ufpr.dl.sourceforge.net/sourceforge/phpldapadmin/phpldapadmin-1.1.0.7.tar.gz&lt;br&gt; # tar -zvzf phpldapadmin-1.1.0.7.tar.gz&lt;br&gt; # mv phpldapadmin-1.1.0.7 phpldapadmin&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #000000;"&gt;Copiaremos a pasta &lt;strong&gt;&lt;em&gt;“phpldapadmin”&lt;/em&gt;&lt;/strong&gt; na pasta do apache&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #808080;"&gt;&lt;em&gt;&lt;strong&gt;# mv phpldapadmin /srv/www/htdocs&lt;/strong&gt;&lt;/em&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Acesse a pasta onde estão as configurações de seu samba, lá você irá encontrar um arquivo de configuração devidamente configurado para se conectar ao samba4, copie para a pasta de configuração do &lt;strong&gt;&lt;em&gt;“phpLDAPadmin”&lt;/em&gt;&lt;/strong&gt;.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #808080;"&gt;&lt;strong&gt;# cd /var/lib/samba/private&lt;br&gt; # cp phpldapadmin-config.php /srv/www/htdocs/ldap/config/config.php&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #000000;"&gt;Seu apache deve estar devidamente configurado com suporte a PHP. Caso você esteje utilizando o Slackware Linux, apenas descomente a linha “&lt;em&gt;&lt;strong&gt;Include /etc/httpd/mod_php.conf” &lt;/strong&gt;&lt;/em&gt;de seu &lt;strong&gt;&lt;em&gt;“httpd.conf”&lt;/em&gt;&lt;/strong&gt; em&lt;em&gt;&lt;strong&gt; “/etc/httpd”&lt;/strong&gt;&lt;/em&gt; e reinicie o apache:&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #808080;"&gt;&lt;strong&gt;# apachectl restart&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #000000;"&gt;Abra seu navegador no seguinte endereço:&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #000000;"&gt;&lt;em&gt;&lt;strong&gt;http://localhost/phpldapadmin/index.php&lt;/strong&gt;&lt;/em&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #000000;"&gt;Irá abrir a pagina lhe pedindo usuário e senha, você pode conectar usando o usuário &lt;strong&gt;&lt;em&gt;“Anônimo”&lt;/em&gt;&lt;/strong&gt; ou como &lt;strong&gt;&lt;em&gt;“Administrator”&lt;/em&gt;&lt;/strong&gt;.&lt;br&gt; Para se conectar como &lt;em&gt;&lt;strong&gt;“Administrator”&lt;/strong&gt;&lt;/em&gt; você deve indicar o caminho completo da localização do usuário, neste caso ele se encontra em &lt;em&gt;&lt;strong&gt;“CN=Users,DC=dtux,DC=org”&lt;/strong&gt;&lt;/em&gt;, para o usuário &lt;strong&gt;&lt;em&gt;“Administrator”&lt;/em&gt; &lt;/strong&gt;ficará assim:&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #808080;"&gt;&lt;strong&gt;CN=Administrator,CN=Users,DC=dtux,DC=org&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;span style="color: #000000;"&gt;Você pode se conectar com qualquer usuário desde que indique o seu caminho completo, assim como o&lt;em&gt;&lt;strong&gt; “Administrator”.&lt;/strong&gt;&lt;/em&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt; &lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;a href="http://samba4.wordpress.com/2009/09/25/instalacao-samba4/login2/"&gt;&lt;img title="login2" class="aligncenter size-full wp-image-38" src="http://samba4.files.wordpress.com/2009/09/login2.jpg?w=447&amp;amp;h=180" height="180" alt="login2" width="447"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;a href="http://samba4.wordpress.com/2009/09/25/instalacao-samba4/login1/"&gt;&lt;img title="login1" class="aligncenter size-full wp-image-40" src="http://samba4.files.wordpress.com/2009/09/login1.jpeg?w=524&amp;amp;h=326" height="326" alt="login1" width="524"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt; &lt;/p&gt;
&lt;p&gt;Arquivos de configuração, lembrando que esse foram usados na minha estrutura, lembre-se cada caso é um caso:&lt;/p&gt;
&lt;p&gt;&lt;a href="/diegoanna/samba4/smb.conf"&gt;&lt;img src="/images/icons-mime/unknown.png?1243378169" alt="Unknown"&gt;smb.conf &lt;/a&gt;- Arquivo de configuração do samba&lt;a href="/diegoanna/samba4/smb.conf"&gt;&lt;br&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="/diegoanna/samba4/named.conf"&gt;&lt;img src="/images/icons-mime/unknown.png?1243378169" alt="Unknown"&gt;named.conf &lt;/a&gt;- Arquivo principal do bind&lt;a href="/diegoanna/samba4/named.conf"&gt;&lt;br&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="/diegoanna/samba4/dtux.org.zone"&gt;&lt;img src="/images/icons-mime/unknown.png?1243378169" alt="Unknown"&gt;dtux.org.zone &lt;/a&gt;- Zona principal criada pelo samba e adaptada&lt;a href="/diegoanna/samba4/dtux.org.zone"&gt;&lt;br&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="/diegoanna/samba4/11.168.192.in-addr.arpa"&gt;&lt;img src="/images/icons-mime/unknown.png?1243378169" alt="Unknown"&gt;11.168.192.in-addr.arpa &lt;/a&gt;- Zona Reversa baseada na Zona Principal&lt;a href="/diegoanna/samba4/11.168.192.in-addr.arpa"&gt;&lt;br&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="/diegoanna/samba4/krb5.conf"&gt;&lt;img src="/images/icons-mime/unknown.png?1243378169" alt="Unknown"&gt;krb5.conf &lt;/a&gt;- Arquivo de configuração do Keberos criado pelo samba&lt;a href="/diegoanna/samba4/krb5.conf"&gt;&lt;br&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="/diegoanna/samba4/adminsamba4.sh"&gt;&lt;img src="/images/icons-mime/unknown.png?1243378169" alt="Unknown"&gt;adminSamba4.sh &lt;/a&gt;- Script criado por mim, para ajuda na tarefa de criar usuários no linux e im porta-los para Active Directory do Samba4, simple que pode evoluir, sujestões são aceitas.&lt;/p&gt;
&lt;p&gt; &lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Fontes de Apoio: &lt;/strong&gt;http://wiki.samba.org/index.php/Samba4/HOWTO &lt;br&gt; http://www.vivaolinux.com.br/artigo/Samba-4-como-controlador-de-dominio-com-Active-Directory-da-MS&lt;br&gt; http://www.nisled.org/?p=68&lt;/p&gt;</description><pubDate>Thu, 01 Oct 2009 11:10:46 +0000</pubDate><link>http://softwarelivre.org/dtux/blog/instalacao-e-configuracao-do-samba4</link><guid>http://softwarelivre.org/dtux/blog/instalacao-e-configuracao-do-samba4</guid></item></channel></rss>