orders={locales:{noneSelected:""},order:{reload:function(e,t){var r=$(e).parents(".order-view");loading_overlay.show(r),$.getScript(t,function(){loading_overlay.hide(r)})},submit:function(e){var t=$(e).parents(".order-view");return $(e).ajaxSubmit({dataType:"script",beforeSubmit:function(){loading_overlay.show(t)},success:function(){loading_overlay.hide(t)}}),!1}},item:{edit:function(){},edit_quantity:function(e){e=$(e),toggle_edit.edit(e);var t=e.find(".quantity input");t.focus()},quantity_keydown:function(e,t){if(13==t.keyCode){var r=$(e).parents(".item");return r.find(".more .submit").get(0).onclick(),t.preventDefault(),!1}},admin_add:{search_url:null,add_url:null,source:null,load:function(e){var t=this,r=$("#order-row-"+e+" .order-product-add .add-input");this.source=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.obj.whitespace("value"),queryTokenizer:Bloodhound.tokenizers.whitespace,remote:this.search_url+"&query=%QUERY"}),this.source.initialize(),r.typeahead({minLength:2,highlight:!0},{displayKey:"label",source:this.source.ttAdapter()}).on("typeahead:selected",function(e,i){r.val(""),$.post(t.add_url,{product_id:i.value},function(){})})}},admin_remove:function(e,t){var r=($(e).parents(".order-items-container"),$(e).parents(".item")),i=r.find(".quantity input");i.val("0"),this.submit(e,t)},submit:function(e,t){var r=$(e).parents(".order-items-container"),i=$(e).parents(".item"),n=i.find(".quantity input"),o={};o[n[0].name]=n.val(),loading_overlay.show(r),$.post(t,o,function(){},"script")}},admin:{toggle_edit:function(){sortable_table.edit_arrow_toggle(toggle_edit.editing(),toggle_edit.isEditing())},load_edit:function(e,t){var r=$(e).find(".box-edit");r.load(t,function(){r.removeClass("loading")}),$(e).attr("onclick","")},select:{all:function(){$(".order #order_ids_").attr("checked",!0)},none:function(){$(".order #order_ids_").attr("checked",!1)},selection:function(){return $(".order #order_ids_:checked").parents(".order")},report:function(e){var t=this.selection().map(function(e,t){return $(t).attr("data-id")}).toArray();return 0===t.length?void alert(orders.locales.noneSelected):void(window.location.href=e+"&"+$.param({ids:t}))}}},setOrderMaxHeight:function(){ordersH=$(window).height(),ordersH-=$("#cirandas-top-bar").outerHeight(),ordersH-=$(".order-view form > .actions").outerHeight(!0),$(".order-view .order-data").css("max-height",ordersH)},daterangepicker:{init:function(e,t){var r=$.extend({},orders.daterangepicker.defaultOptions,t),i=$(e),n=i.parents(".daterangepicker-field-container"),o=n.find("input[data-field=start]"),a=n.find("input[data-field=end]"),d=moment(o.val(),moment.ISO_8601).format(r.format),s=moment(a.val(),moment.ISO_8601).format(r.format),u=d+r.separator+s;i.val(u),i.daterangepicker(r).on("apply.daterangepicker change",function(e,t){t=i.data("daterangepicker"),o.val(t.startDate.toDate().toISOString()),a.val(t.endDate.toDate().toISOString())})}}},$(document).ready(orders.setOrderMaxHeight),$(window).resize(orders.setOrderMaxHeight),$("#order_supplier_delivery_id").change(orders.setOrderMaxHeight);